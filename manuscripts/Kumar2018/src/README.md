# Material and Methods

This file contains extract from the [manuscript](https://onlinelibrary.wiley.com/doi/full/10.1111/tpj.14417) as well as some extra information.

## Raw data
The Imanen data can be retrieved from the ENA under the PRJEB13583 accession.
The Atlas data can be retrieved from the ENA under the PRJEB5040 accession.
The Aspwood data can be retrieved from the ENA under the PRJEB14593 accession.

## Establishment of CAZyme expression matrix for comparative analyses

The high‐resolution RNA‐Seq data sets for the wild and glasshouse grown aspen (Populus tremula L.) are available from the PlantGenIE website (Sundell et al., 2015), and those for glasshouse‐grown hybrid aspen phloem, cambium and developing xylem are detailed by Immanen et al. (2016). The retrieved data were pre‐processed according to our guidelines as described by Delhomme et al. (http://www.epigenesys.eu/en/protocols/bio-informatics/1283-guidelines-for-rna-seq-data-analysis). Briefly, the quality of the raw sequence data was assessed using fastqc (http://www.bioinformatics.babraham.ac.uk/projects/fastqc/). Residual ribosomal RNA (rRNA) contamination was assessed and filtered using sortmerna 2.1 (with settings –log –fastx –sam –num_alignments 1 for both data sets, with the addition of –paired_in for the AspWood data set; Kopylova et al., 2012) using the rRNA sequences provided with sortmerna (rfam‐5s‐database‐id98.fasta, rfam‐5.8s‐database‐id98.fasta, silva‐arc‐16s‐database‐id95.fasta, silva‐bac‐16s‐database‐id85.fasta, silva‐euk‐18s‐database‐id95.fasta, silva‐arc‐23s‐database‐id98.fasta, silva‐bac‐23s‐database‐id98.fasta and silva‐euk‐28s‐database‐id98.fasta). Data were then filtered to remove adapters and trimmed for quality using trimmomatic 0.32 (with settings TruSeq3‐PE‐2.fa:2:30:10 LEADING:3 SLIDINGWINDOW:5:20 MINLEN:50; Bolger et al., 2014). After both filtering steps, fastqc was run again to ensure that no technical artefacts were introduced. Filtered reads were aligned to v3.0 of the P. trichocarpa genome (https://phytozome.jgi.doe.gov/pz/portal.html, November 2018), using star 2.5.2b (with non‐default settings –outSAMstrandField intronMotif –readFilesCommand zcat –outSAMmapqUnique 254 –quantMode TranscriptomeSAM –outFilterMultimapNmax100 –outReadsUnmapped Fastx –chimSegmentMin1 –outSAMtype BAM SortedByCoordinate –outWigType bedGraph –alignIntronMax11000; Dobin et al., 2013). The annotations obtained from the P. trichocarpa v3.0 GFF file were flattened to generate ‘synthetic’ gene models. This synthetic transcript GFF file and the star read alignments were used as input to the HTSeq (Anders et al., 2014) htseq‐count python utility to calculate exon‐based read count values. The htseq‐count utility takes only unique mapping reads into account. Because of their different characteristics (differences in sampling, sequencing instruments, etc.), the data sets were normalized independently. First, the data sets were normalized using variance stabilizing transformation (VST) in r 3.4.0 (R Core Team, 2015) using the bioconductor 3.4 (Gentleman et al., 2004) deseq2 package (v1.16.1; Love et al., 2014). Furthermore, the data from Immanen et al. (2016) were then filtered and samples corresponding to the zones of interest were identified (phloem, cambium and developing xylem) and selected from the three control trees: 4A, 4B and 6B. A likely artefact introduced by decreasing library sizes as samples moved inwards (towards the xylem) was identified and was corrected using a linear modeling approach. Finally, the data from both data sets were merged together using a sample‐based median‐centering approach. The resulting data were subjected to hierarchical clustering and the τ tissue/sample specificity score (Yanai et al., 2004) was calculated, both in r. The whole data analysis was performed using custom r scripts available from our GitHub repository (https://github.com/UPSCb/UPSCb/tree/master/manuscripts/Kumar2018) and the corresponding data are available from our FTP repository (ftp://ftp.plantgenie.org/Publications/Kumar2018).

## Replication of the R analyses
The FTP listed above contains the necessary data. Make sure to retrieve it and to edit the paths in the analysis listed in this directory.

The html files listed in the subdirectories are transcript of the analysis, including all the code sections. If you would require the R code from practicality, approach us.

For the selection of the sample from the Atlas and the Immanen _et al._ data, the relevant data is described within the R code. Briefly for Immanen _et al._ the samples "AF01","AF02","AF03" have been assigned to Phloem, the samples "AF04","AF05","AF06" to Cambium and the rest "AF07" to "AF12" to Xylem. For the Atlas, the ID R1-R24 have been used throughout and are described in the metadata on the FTP, in the asp201-samples.csv file.

For the normalization of the datasets described above, check out the `Normalization` folder and run the script in alphabetic order, _i.e._ from `01...` to `03...`. Similarly for the TissueSpecificity analysis.
